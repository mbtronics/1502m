10 ON ERROR GOTO 750
20 DEFINT A-Z
50 KEY OFF
60 CLS
70 FOR I = 1 TO 10
80 KEY I, ""
85 NEXT I
90 BR = &HBB: BR1 = 2400
95 K$ = CHR$(180)
100 DIM BUF$(21), CUR$(16)
105 GOSUB 300
110 GOSUB 850
115 FILE$ = "": AUXF$ = ""
120 BP = 1: INS$ = "": WR$ = ""
130 BUF$(BP) = SPACE$(80)
135 GOSUB 4020
140 GOSUB 1000
150 CLS
160 GOSUB 875
165 GOTO 115
300 'CREATE TABLE
305 DIM T$(30)
310 T$(1) = "<SHIFT" + CHR$(17) + ">"
315 T$(2) = "<SHIFT" + CHR$(16) + ">"
320 T$(3) = "<SCRA" + CHR$(24) + ">"
325 T$(4) = "<SCRA" + CHR$(25) + ">"
330 T$(5) = "<APPEAR>"
335 T$(6) = "<JUMPON>"
340 T$(7) = "<OPEN" + CHR$(17) + ">"
345 T$(8) = "<OPEN" + CHR$(16) + ">"
350 T$(9) = "<OPEN" + CHR$(24) + ">"
355 T$(10) = "<OPEN" + CHR$(25) + ">"
360 T$(11) = "<OPEN" + CHR$(17) + CHR$(16) + ">"
365 T$(12) = "<OPEN" + CHR$(16) + CHR$(17) + ">"
370 T$(13) = "<ROTA" + CHR$(24) + ">"
375 T$(14) = "<ROTA" + CHR$(25) + ">"
380 T$(15) = "<SCRD" + CHR$(24) + ">"
385 T$(16) = "<SCRD" + CHR$(25) + ">"
390 T$(17) = "<CLEAR>"
395 T$(18) = "<PAUSE>"
400 T$(19) = "<WIPE" + CHR$(17) + ">"
405 T$(20) = "<WIPE" + CHR$(16) + ">"
410 T$(21) = "<WIPE" + CHR$(24) + ">"
415 T$(22) = "<WIPE" + CHR$(25) + ">"
420 T$(23) = "<WIPE" + CHR$(17) + CHR$(16) + ">"
425 T$(24) = "<WIPE" + CHR$(16) + CHR$(17) + ">"
430 T$(25) = "<END>"
435 T$(26) = "<CLOCK>"
440 T$(27) = "<HALT>"
445 T$(28) = "<SPEED>"
450 T$(29) = "<FAT>"
455 T$(30) = "<FLASH>"
460 DIM F1$(13)
465 FOR I = 1 TO 13
470 READ F1$(I)
475 NEXT
480 DATA Shift-,Ctrl-,Alt-,F1,F2
485 DATA F3, F4, F5, F6, F7, F8, F9, F0
490 DIM F2$(11)
495 FOR I = 1 TO 11
500 READ F2$(I)
505 NEXT
510 DATA Quit, System, Insert, Delete
515 DATA Clear,Execute,Save,Open
520 DATA Kill,Function,"Esc:Exit"
525 RETURN

600 'FILENAME
601 AUXF$ = FILE$
602 OP = 0
603 LOCATE 23, 10, 0: PRINT SPACE$(70);
605 COLOR 0, 15
610 LOCATE 23, 1
615 PRINT "FILE NAME";
620 COLOR 15, 0
625 LOCATE 23, 11
630 LINE INPUT FILE$
635 RETURN

650 'OPEN
655 OPEN "I", #1, FILE$
660 INPUT #1, BP
665 FOR I = 1 TO BP
670 INPUT #1, BUF$(I)
675 NEXT
680 IX = 1: IY = 1
685 AUXF$ = FILE$
690 CLOSE #1
695 RETURN

700 'WRITE
705 OPEN "O", #1, FILE$
710 WRITE #1, BP
715 FOR I = 1 TO BP
720 WRITE #1, BUF$(I)
725 NEXT
730 IX = 1: IY = 1
731 AUXF$ = FILE$
735 CLOSE #1
740 RETURN

750 'ERROR MESSAGE
751 OP = 0
752 LOCATE 24, 11
754 COLOR 0, 15
756 IF ERR <> 53 THEN GOTO 762
758 PRINT "File not found";
760 GOTO 805
762 IF ERR <> 54 THEN GOTO 768
764 PRINT "Bad file mode";
766 GOTO 806
768 IF ERR <> 57 THEN GOTO 774
770 PRINT "Device I/O error";
772 GOTO 806
774 IF ERR <> 61 THEN GOTO 780
776 PRINT "Disk full";
778 GOTO 806
780 IF ERR <> 67 THEN GOTO 786
782 PRINT "Too many files";
784 GOTO 806
786 IF ERR <> 70 THEN GOTO 792
788 PRINT "Disk write protect";
790 GOTO 806
792 IF ERR <> 71 THEN GOTO 798
794 PRINT "Disk not ready";
796 GOTO 805
798 IF ERR <> 72 THEN GOTO 804
800 PRINT "Disk media error";
802 GOTO 806
804 PRINT "Bad file name";
805 IF ASC(A$) = 66 THEN OP = 1
806 IF ASC(A$) = 67 THEN OP = 2
807 COLOR 15, 0
808 PRINT SPC(5); "Prsee any key to continue .....";
810 IF INKEY$ = "" THEN GOTO 810
812 LOCATE 23, 10: PRINT SPACE$(70);
814 FILE$ = ""
820 IF OP = 1 THEN GOTO 824
821 IF OP = 2 THEN RESUME 930
822 RESUME 690
824 RESUME 735
850 'KEY
855 DIM F3$(10)
860 FOR I = 1 TO 10
865 READ F3$(I)
870 NEXT
871 DATA Quit,End,Ins,Del,Clr
872 DATA Run,Save,Open,Kill,Fun
875 LOCATE 25, 1, 0
880 FOR I = 1 TO 10
885 B = LEN(F3$(I))
886 PRINT F1$(I + 3);
887 COLOR 0, 15
888 PRINT F3$(I);
889 COLOR 15, 0
890 IF I = 10 THEN B = 5
891 PRINT SPACE$(6 - B);
892 NEXT
895 RETURN

900 'KILL
905 COLOR 0, 15
910 LOCATE 24, 35, 0: PRINT "Kill";
915 COLOR 15, 0
920 GOSUB 600
925 KILL FILE$
930 GOSUB 1253
935 GOTO 1045
950 'EXIT
955 LOCATE 24, 11, 1
960 PRINT "Are you sure ? (y/n)";
965 A$ = INKEY$: IF A$ = "" THEN GOTO 965
970 IF A$ = "n" OR A$ = "N" THEN GOTO 985
977 IF A$ = "y" OR A$ = "Y" THEN CLS : END
980 GOTO 965
985 LOCATE 24, 11: PRINT SPACE$(22);
990 GOTO 1045
1000 'KEY TEST
1005 K1 = 0
1010 IX = 1: IY = 1
1015 LOCATE IX, IY
1020 PRINT "== TOP  ==";
1025 PRINT SPACE$(64);
1030 GOSUB 2280
1035 J1 = 1: J2 = BP
1045 LOCATE IX + 1, IY, 1, K1, 13
1050 A$ = INKEY$: IF A$ = "" THEN GOTO 1050
1055 IF LEN(A$) = 2 THEN GOTO 1170
1060 IF A$ <> CHR$(13) THEN GOTO 1085
1065 IF IX = BP THEN GOTO 1075
1070 IX = IX + 1
1075 IY = 1
1080 GOTO 1660
1085 IF A$ = CHR$(27) THEN GOTO 3800
1090 IF ASC(A$) = 8 THEN GOTO 1800
1095 IF ASC(A$) = 9 THEN GOTO 2030
1100 B$ = A$: B = ASC(A$)
1105 IF B < 32 THEN GOTO 1045
1110 IF B > 126 AND B < 180 THEN GOTO 1045
1115 IF B > 210 THEN GOTO 1045
1120 WR$ = "ON"
1122 IF INS$ = "ON" THEN GOTO 1555
1125 B = LEN(A$) + IY - 1
1130 IF B > 80 THEN GOTO 1045
1135 B1 = LEN(A$)
1140 MID$(BUF$(IX), IY, B1) = B$
1145 PRINT A$;
1150 IY = IY + B1
1155 IF IY > 80 THEN IY = 80: GOTO 1510
1160 GOSUB 1955
1165 GOTO 1045
1170 A$ = RIGHT$(A$, 1)
1175 B = ASC(A$)
1180 IF B = 15 THEN GOTO 2080
1185 IF B >= 59 AND B <= 68 THEN GOTO 1200
1190 IF B >= 71 AND B <= 83 THEN GOTO 1395
1195 IF B >= 84 AND B <= 113 THEN GOTO 1825
1199 GOTO 1045
1200 IF I1 = 0 THEN GOTO 1205
1201 B = B + I1 * 10 + 15
1202 GOTO 1825
1205 'KEY 1
1210 IF B = 59 THEN GOTO 4100
1215 IF B = 60 THEN GOTO 950
1220 IF B = 61 THEN GOTO 1263
1225 IF B = 62 THEN GOTO 1265
1230 IF B = 63 THEN GOTO 1310
1235 IF B = 64 THEN GOTO 1275
1240 IF B = 65 THEN GOTO 1335
1241 IF B = 67 THEN GOTO 900
1242 IF B = 68 THEN GOTO 1320
1245 GOSUB 600
1247 GOSUB 650
1248 GOSUB 1253
1249 IF OP = 1 THEN GOTO 1252
1250 J1 = 1: J2 = BP: WR$ = ""
1251 GOSUB 2320: GOSUB 2445
1252 GOTO 1045
1253 FILE$ = AUXF$
1254 B = LEN(FILE$)
1255 IF B = 0 THEN GOTO 1259
1256 LOCATE 23, 11
1257 PRINT FILE$; SPACE$(69 - B);
1258 GOTO 1260
1259 LOCATE 23, 1: PRINT SPACE$(80);
1260 LOCATE 24, 11: PRINT SPACE$(50);
1261 RETURN

1263 GOSUB 2150
1264 GOTO 1665
1265 GOSUB 2215
1270 GOTO 1665
1275 GOSUB 2475
1280 GOTO 1675
1285 WH = 13: WW = 14
1290 XY = 50: YX = 6
1295 GOSUB 3315
1300 GOSUB 3600
1305 GOTO 1675
1310 GOSUB 2120
1315 GOTO 1665
1320 GOSUB 3300
1325 GOSUB 3200
1330 GOTO 1675
1335 GOSUB 1350
1340 GOTO 1675
1345 GOTO 1350
1350 'WRITE
1355 WR$ = ""
1360 COLOR 0, 15
1365 LOCATE 24, 35, 0: PRINT "Write";
1370 COLOR 15, 0
1375 GOSUB 600: GOSUB 700
1376 GOSUB 1253
1380 LOCATE 24, 35: PRINT SPC(5);
1385 OUT 97, 76
1390 RETURN

1395 'KEY 2
1400 IF B = 71 THEN GOTO 1445
1405 IF B = 72 THEN GOTO 1455
1406 IF B = 73 THEN GOTO 1285
1410 IF B = 75 THEN GOTO 1470
1415 IF B = 77 THEN GOTO 1485
1420 IF B = 79 THEN GOTO 1510
1425 IF B = 80 THEN GOTO 1520
1426 IF B = 81 THEN GOTO 4050
1430 IF B = 82 THEN GOTO 1535
1435 IF B = 83 THEN GOTO 1860
1440 GOTO 1045
1445 IY = 1
1450 GOTO 1640
1455 IF IX = 1 THEN GOTO 1660
1460 IX = IX - 1
1465 GOTO 1640
1470 IF IY = 1 THEN GOTO 1660
1475 IY = IY - 1
1480 GOTO 1640
1485 IF IY = 80 THEN GOTO 1660
1490 B = ASC(MID$(BUF$(IX), IY, 1))
1495 IY = IY + 1
1500 IF B > 180 THEN GOTO 1740
1505 GOTO 1660
1510 IY = 80
1515 GOTO 1640
1520 IF IX = BP THEN GOTO 1660
1525 IX = IX + 1
1530 GOTO 1640
1535 IF INS$ <> "" THEN GOTO 1660
1540 INS$ = "ON"
1545 K1 = 10
1550 GOTO 1045
1555 B1$ = B$: B$ = A$: A$ = B1$
1560 GOSUB 1895
1565 BUF$(IX) = MID$(B1$ + A$ + B2$, 1, 80)
1570 B = ASC(MID$(BUF$(IX), 80, 1))
1575 IF B < 180 THEN GOTO 1630
1580 B$ = BUF$(IX): C = 0
1585 FOR I = 80 TO 1 STEP -1
1590 IF ASC(MID$(B$, I, 1)) <> 180 THEN GOTO 1605
1595 C = C + 1
1600 NEXT
1605 C = C + 1
1610 B = ASC(MID$(B$, I, 1))
1615 B = LEN(T$(B - 180))
1620 IF B = C THEN GOTO 1630
1625 MID$(BUF$(IX), I, C) = SPACE$(C)
1630 J = IX: GOSUB 2355
1635 GOTO 1150
1640 B$ = MID$(BUF$(IX), IY, 1)
1645 B = ASC(B$)
1650 IF B <> 180 THEN GOTO 1660
1655 GOSUB 1680
1660 IF A$ = CHR$(8) THEN GOTO 1865
1665 INS$ = ""
1670 K1 = 0
1675 GOTO 1045
1680 'SEARCH LEFT
1685 B$ = MID$(BUF$(IX), 1, IY)
1690 B1 = ASC(MID$(BUF$(IX), IY, 1))
1695 FOR I = IY TO 1 STEP -1
1700 B = ASC(MID$(B$, I, 1))
1705 IF B <> B1 THEN GOTO 1715
1710 NEXT
1715 IF I > 1 THEN GOTO 1730
1720 IY = 1
1725 GOTO 1735
1730 IY = I
1735 RETURN

1740 'SEARCH RIGHT
1745 B$ = BUF$(IX)
1750 B1 = ASC(MID$(B$, IY, 1))
1755 FOR I = IY TO 80
1760 B = ASC(MID$(B$, I, 1))
1765 IF B <> B1 THEN GOTO 1775
1770 NEXT
1775 IF I <= 80 THEN GOTO 1790
1780 GOSUB 1680
1785 GOTO 1660
1790 IY = I
1795 GOTO 1660
1800 'CHR$(8)
1805 X = 1: IY = IY - 1
1810 IF IY >= 2 THEN GOTO 1640
1815 IY = 1: X = 0
1820 GOTO 1865
1825 'KEY 3
1830 B = B - 83
1835 A$ = T$(B): B$ = CHR$(180 + B)
1840 FOR I = 2 TO LEN(A$)
1845 B$ = B$ + CHR$(180)
1850 NEXT
1855 GOTO 1120
1860 INS$ = "": K1 = 0
1865 GOSUB 1885
1870 BUF$(IX) = B1$ + B2$ + SPACE$(B1 - B)
1875 J = IX: GOSUB 2355
1880 GOTO 1045
1885 'DEL A CHAR
1890 B$ = MID$(BUF$(IX), IY, 1)
1895 B1 = ASC(B$)
1900 B = 0: WR$ = "ON"
1905 IF B1 <= 180 THEN GOTO 1915
1910 B$ = T$(B1 - 180)
1915 B1 = LEN(B$)
1920 IF INS$ <> "ON" THEN GOTO 1935
1925 B = B1
1930 IF ASC(A$) = 8 THEN B = 0
1935 B$ = BUF$(IX)
1940 B1$ = MID$(B$, 1, IY - 1)
1945 B2$ = MID$(B$, IY - B + B1)
1950 RETURN

1955 'MODIFY
1960 B$ = MID$(BUF$(IX), IY, 1)
1965 IF ASC(B$) <> 180 THEN GOTO 2025
1970 B$ = BUF$(IX): C = 0
1975 FOR I = IY TO 80
1980 B = ASC(MID$(B$, I, 1))
1985 IF B <> 180 THEN GOTO 2000
1990 C = C + 1
1995 NEXT
2000 B$ = MID$(B$, IY, C)
2005 B1 = 0
2010 GOSUB 1900
2015 BUF$(IX) = B1$ + B2$ + SPACE$(C)
2020 GOSUB 2315
2025 RETURN

2030 'TAB
2035 Q = 8 - (IY MOD 8)
2040 K = 0: IF IY + Q > 80 THEN GOTO 1045
2045 IF INS$ = "" THEN GOTO 2060
2050 B$ = SPACE$(Q): A$ = B$
2055 K = 1: GOTO 1560
2060 IY = IY + Q
2065 B$ = MID$(BUF$(IX), IY, 1)
2070 IF ASC(B$) <> 180 THEN GOTO 1045
2075 GOTO 1740
2080 'SHF-TAB
2085 Q = IY MOD 8
2090 IF IY - (8 - Q) <= 0 THEN GOTO 1045
2095 IF Q = 0 THEN GOTO 2110
2100 IY = IY + Q - 8
2105 GOTO 2115
2110 IY = IY - 8
2115 GOTO 1640
2120 'SPACE
2125 IY = 1
2130 BUF$(IX) = SPACE$(80)
2135 LOCATE IX + 1, IY, 0
2140 PRINT BUF$(IX)
2145 RETURN

2150 'INSERT A LINE
2155 IX = IX + 1: IF IX > 20 THEN IX = 20
2160 FOR I = BP TO IX STEP -1
2165 BUF$(I + 1) = BUF$(I)
2170 NEXT
2175 BP = BP + 1: IF BP <= 20 THEN GOTO 2190
2180 BP = 20
2185 BUF$(21) = SPACE$(80)
2190 BUF$(IX) = SPACE$(80)
2195 IY = 1
2200 J1 = IX: J2 = BP
2205 GOSUB 2320
2210 GOTO 2280
2215 'DELETE A LINE
2220 IF BP <= 1 THEN GOSUB 2120: GOTO 2280
2225 BP = BP - 1
2230 FOR I = IX TO BP
2235 BUF$(I) = BUF$(I + 1)
2240 NEXT
2245 IY = 1
2250 IF IX <= BP THEN GOTO 2265
2255 IX = BP
2260 GOTO 2280
2265 J1 = IX: J2 = BP
2270 BUF$(I) = SPACE$(80)
2275 GOSUB 2320
2280 LOCATE BP + 2, 1, 0
2285 PRINT "= BOTTOM =";
2290 PRINT SPACE$(70);
2291 IF BP >= 20 THEN GOTO 2305
2295 LOCATE BP + 3, 1
2300 PRINT SPACE$(80);
2305 RETURN

2310 'DISPLAY
2315 J1 = IX: J2 = IX
2320 COLOR 0, 15
2325 LOCATE 24, 35: PRINT "Display";
2330 COLOR 15, 0
2335 LOCATE IX + 1, IY, 0
2340 FOR J = J1 TO J2
2345 GOSUB 2360
2350 GOTO 2425
2355 LOCATE IX + 1, IY, 0
2360 B$ = BUF$(J)
2365 I = IY
2370 B2 = INSTR(I, B$, K$)
2375 IF B2 <= 0 THEN GOTO 2415
2380 B2 = B2 - 1
2385 B = ASC(MID$(B$, B2, 1)) - 180
2390 PRINT MID$(B$, I, B2 - I);
2395 PRINT T$(B);
2400 I = B2 + LEN(T$(B))
2405 IF I > 80 THEN GOTO 2420
2410 GOTO 2370
2415 PRINT MID$(B$, I, 80);
2420 RETURN

2425 NEXT J
2426 GOSUB 2280
2435 LOCATE 24, 35: PRINT SPC(7);
2440 RETURN

2445 'DISP SPC
2450 FOR I = BP + 3 TO 22
2455 LOCATE I, 1
2460 PRINT SPACE$(80);
2465 NEXT
2470 RETURN

2475 'EXECUTE
2480 OPEN "COM1:2400,E,8,1,RS,DS,CS,CD" FOR RANDOM AS #3
2490 Z = 0: COLOR 0, 15
2495 LOCATE 24, 35: PRINT "Execute";
2500 COLOR 15, 0
2505 LOCATE IX, IY, 0
2515 FOR J = 1 TO BP
2520 B$ = BUF$(J)
2525 FOR I = 1 TO 80
2530 Z = Z + 1
2535 B1 = 1
2540 B = ASC(MID$(B$, I, 1))
2545 IF B < 180 THEN GOTO 2570
2550 B = B - 180
2555 B1 = LEN(T$(B))
2560 IF B > 13 THEN GOTO 2570
2565 B = B - 1
2570 PRINT #3, CHR$(B);
2575 I = I + B1 - 1
2580 NEXT I
2585 NEXT J
2590 PRINT #3, CHR$(13);
2610 LOCATE 24, 35: PRINT SPC(7);
2620 CLOSE #3: RETURN

3200 'HELP
3205 AP = 1: H1 = 1: GOSUB 3500
3210 A$ = INKEY$: IF A$ = "" THEN GOTO 3210
3215 IF LEN(A$) = 2 THEN GOTO 3230
3220 IF A$ = CHR$(27) THEN GOTO 3400
3225 GOTO 3210
3230 A$ = RIGHT$(A$, 1)
3235 IF ASC(A$) <> 73 THEN GOTO 3260
3240 IF AP = 1 THEN GOTO 3280
3245 AP = AP - 1: H1 = H1 - 10
3250 GOSUB 3500
3255 GOTO 3280
3260 IF ASC(A$) <> 81 THEN GOTO 3280
3265 IF AP = 3 THEN GOTO 3280
3270 AP = AP + 1: H1 = H1 + 10
3275 GOSUB 3500
3280 GOTO 3210
3300 'WINDOW
3305 XY = 30: YX = 5
3310 WH = 14: WW = 13
3315 N = 1
3320 FOR Y = YX TO YX + WH - 1
3325 CUR$(N) = ""
3330 FOR X = XY TO XY + WW - 1
3335 CUR$(N) = CUR$(N) + CHR$(SCREEN(Y, X))
3340 NEXT X
3345 N = N + 1
3350 NEXT Y
3355 LOCATE YX, XY
3360 PRINT CHR$(218); STRING$(WW - 2, 196); CHR$(191);
3365 FOR Y = YX + 1 TO YX + WH - 2
3370 LOCATE Y, XY
3375 PRINT CHR$(179); SPACE$(WW - 2); CHR$(179);
3380 NEXT Y
3385 LOCATE YX + WH - 1, XY
3390 PRINT CHR$(192); STRING$(WW - 2, 196); CHR$(217);
3395 RETURN

3400 'RESTORE
3405 FOR Y = YX + WH - 1 TO YX STEP -1
3410 N = N - 1
3415 LOCATE Y, XY
3420 PRINT CUR$(N);
3425 NEXT Y
3430 RETURN

3500 'FUNCTION1
3505 H2 = LEN(F1$(AP)) + 2
3510 LOCATE YX + 1, XY + 1
3515 PRINT F1$(AP); SPC(WW - H2);
3520 FOR I = H1 TO H1 + 9
3525 H2 = LEN(T$(I)) + 5
3530 J = I - H1 + 4
3535 Y = YX + J - 2
3540 LOCATE Y, XY + 1
3545 PRINT F1$(J); ":"; T$(I); SPC(WW - H2);
3550 NEXT I
3555 LOCATE Y + 1, XY + 1
3560 PRINT F2$(11); SPC(3);
3565 RETURN

3600 'FUNCTION2
3605 B = 10
3610 LOCATE YX + 1, XY + 1
3615 PRINT F2$(11); SPC(1);
3620 FOR I = 1 TO B
3625 H2 = LEN(F2$(I)) + 5
3630 J = I + 3
3635 Y = YX + I + 1
3640 LOCATE Y, XY + 1
3645 PRINT F1$(J); ":"; F2$(I); SPC(WW - H2);
3650 NEXT
3655 A$ = INKEY$: IF A$ = "" THEN GOTO 3655
3660 IF A$ <> CHR$(27) THEN GOTO 3655
3665 GOSUB 3400
3670 RETURN

3700 'FUN1
3705 J = 4: I2 = (I1 - 1) * 10 + 1
3710 LOCATE 25, 1, 0
3715 FOR I = I2 TO I2 + 9
3720 B = LEN(T$(I))
3725 PRINT MID$(F1$(J), 2, 1);
3730 COLOR 0, 15
3735 PRINT MID$(T$(I), 2, B - 2);
3740 COLOR 15, 0
3745 IF J = 13 THEN GOTO 3765
3750 PRINT SPACE$(9 - B);
3755 J = J + 1
3760 NEXT
3765 RETURN

3800 'FUN2
3805 I1 = I1 + 1
3810 IF I1 > 3 OR I1 <= 0 THEN GOTO 3825
3815 GOSUB 3700
3820 GOTO 3835
3825 I1 = 0
3830 GOSUB 875
3835 GOTO 1045
3900 'BAUD RATE
3901 I3 = 2400
3905 LOCATE 25, 1, 0
3910 FOR I = 1 TO 4
3915 COLOR 0, 15
3920 PRINT F1$(I + 3);
3925 COLOR 15, 0
3930 PRINT I3;
3935 PRINT SPC(2);
3936 I3 = I3 / 2
3940 NEXT
3945 COLOR 0, 15
3950 PRINT "Esc";
3955 COLOR 15, 0
3960 PRINT " no change";
3965 PRINT SPACE$(27);
3975 A$ = INKEY$: IF A$ = "" THEN GOTO 3975
3980 IF A$ = CHR$(27) THEN GOTO 4020
3985 IF LEN(A$) < 2 THEN GOTO 3975
3990 B = ASC(RIGHT$(A$, 1))
3995 IF B > 62 OR B < 59 THEN GOTO 3975
4000 IF B = 59 THEN BR = &HBB: BR1 = 2400
4005 IF B = 60 THEN BR = &H9B: BR1 = 1200
4010 IF B = 61 THEN BR = &H7B: BR1 = 600
4015 IF B = 62 THEN BR = &H5B: BR1 = 300
4020 LOCATE 24, 65
4025 COLOR 0, 15
4030 PRINT "Baud rate";
4035 COLOR 15, 0
4040 PRINT BR1;
4045 RETURN

4050 GOSUB 3900
4055 I1 = I1 - 1
4060 GOTO 3800
4100 IF WR$ = "" THEN GOTO 4135
4105 LOCATE 24, 11
4110 PRINT "Are you sure ?(y/n)";
4115 A$ = INKEY$: IF A$ = "" THEN GOTO 4115
4120 IF A$ = "y" OR A$ = "Y" THEN GOTO 4135
4125 IF A$ = "n" OR A$ = "N" THEN GOTO 4140
4130 GOTO 4115
4135 RETURN

4140 LOCATE 24, 11
4145 PRINT SPC(20);
4150 GOTO 1045


